<!DOCTYPE html>
<html>
  <head>
    <title>Realtime Notifications</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
    <script src="https://js.pusher.com/4.1/pusher.min.js"></script>


  </head>

  <body>

    <input class="create-notification" placeholder="Send a notification :)"></input>
    <button class="submit-notification">Go!</button>

    <script>

      var pusher = new Pusher('fa1c51d738d6f458f45b', {
        cluster: 'eu',
        encrypted: true
      });

      var notificationsChannel = pusher.subscribe('notifications');

      notificationsChannel.bind('new_notification', function(notification){
        var message = notification.message;
        toastr.success(message)
      });

      var sendNotification = function(){
		      var text = $('input.create-notification').val();
		      $.post('/notification', { message: text }, function success(){
			      console.log('Notification sent!');
		      });
	    };

	    $('button.submit-notification').on('click', sendNotification);

      Pusher.logToConsole = true;

    </script>
  </body>

</html>
